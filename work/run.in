# temperatures obtained from a REMD (Replica exchange molecular dynamics) temp simulator, at:
#   https://virtualchemistry.org/remd-temperature-generator/
variable	T world 300.00 354.47 416.81 488.14 569.86 663.45 764.45 865.45 966.45 1000.0

variable	I world 0 1 2 3 4 5 6 7 8 9

variable	SEED equal 123

units		real
atom_style	molecular
boundary	p p p

read_data	polymer.txt

pair_style	lj/cut 17.5
pair_modify	shift  yes
pair_coeff	1 1 0.5 5.0
mass		1 100.0


bond_style	harmonic
bond_coeff	1 10.0 3.8

special_bonds	lj 0.0 1.0 1.0

neighbor	2.0 bin
neigh_modify    delay 1 every 1 check yes

# ---------- Thermostatting ---------- #
# fix ID group-ID style args
# style = name = * (global), *atom (per-atom), *local, *grid,

# nve = constant N (num particles), constant V (volume), constant E (energy)
fix 1 all nve

# Langevin thermostat
# This fix does NOT perform time integration
# It only modifies forces to effect thermostatting. (Fc + Ff + Fr)
#   Fc = conservative force  (inter-particle bond interactions)
#   Ff = Frictional drag (affected by mass, velocity, damp factor)
#   Fr = Solvent force (affected by Boltzmann k, temperature, mass, dt, damp factor)
# Thus you must use a separate time integration fix, like fix nve to actually update the velocities and positions of
# atoms using the modified forces. Likewise, this fix should not normally be used on atoms that also have their
# temperature controlled by another fix - e.g. by fix nvt

# fix ID group-ID langevin Tstart Tstop damp seed keyword values ...
fix 2 all langevin ${T} ${T} 1000 ${SEED}

fix 3 all recenter INIT INIT INIT

# thermostat the translational velocity of particles
# fix ID group-ID style_name keyword value ...
#   for keyword temp:
#     value = Tstart Tstop Tdamp
fix myfix all nvt temp ${T} ${T} 100.0

timestep	10.0


thermo_style	custom step temp etotal pe ke
thermo		1000


# the trajectories of each replica. These are continuous in coordinate space, not in temperature.
# Before analysis the trajectories must be re-ordered into trajectories of the same temperature.
dump		1 all atom 1000 polymer.${I}.lammpstrj
dump_modify	1 sort id


# parallel tempering
temper		100000 100 $T 2 ${SEED} ${SEED}
